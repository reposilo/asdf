n=17
fac=factor(rep(1:3, len=n), level=1:5)
fac
table(fac)
tapply(1:n, fac, sum)
ls()
rm(fac,n2)
rm(fac)
ls()
rm(n)
N=sample(100)
N
X=sample(100)
X
ls()
remove(N)
remove(X)
x = 1:10
class ( x )
t(x)
class(t(x))
class(t(t(x)))
ls()
rm(x)
x=complex(1,1)
x
?complex
Mod(x)
Conj(x)
rm(x)
getwd()
data()
data(EuStockMarkets)
EuStockMarkets
EuStockMarkets(2,)
EuStockMarkets[2,]
name(EuStockMarkets)
colname(EuStockMarkets)
?colname
?colnames
colnames(EuStockMarkets)
rownames(EuStockMarkets)
plot(EuStockMarkets)
anova(EuStockMarkets)
cor.test(EuStockMarkets$DAX, EuStockMarkets$SMI, EuStockMarkets$CAC, EuStockMarkets$FTSE)
summary(EuStockMarkets)
names(EuStockMarkets)
colnames(EuStockMarkets)
q()
x <- read.csv("q.csv", na.strings = c("NA", 0))
x <- read.csv("q.csv")
q()
x <- read.csv("q.csv", na.strings = c("NA", 0))
read.table("q.csv")
getwd()
read.csv()
?read.csv
q()
.libPaths()
.libPaths("D:\R\Lib\lib")
.libPaths("D:\\R\Lib\lib")
.libPaths("D:/R/Lib/lib")
.libPaths()
quit()
.libPaths()
quit()
.libPaths()
quit()
tmp <- "│薪資存款│    $5,853,714,944│ 734│      $504,324,832│ 121│      $690,670,263│  89│        $1,231,613,474│ 138│      $8,280,323,513│    │                  │"
tmp1 <- gsub(" ","",unlist(strsplit(tmp,"│")))
tmp1
tmp2 <- tmp1[tmp1!=""]
tmp2
tmp2[length(tmp2)]
exit
exit()
q()
.libPaths()
.libPaths("D:/R/Lib/lib")
.libPaths()
EnvVar()
Sys.getenv()
Sys.setenv()
Sys.setenv(R_LIBS_USER="D:/R/Lib/lib")
q()
install.packages("XLConnect")
install.packages("XLConnect")
install.packages("rattle")
install.packages("xlsx")
install.packages("XLConnect")
install.packages("XLConnectJars")
library("xlsx", lib.loc="D:/R/Lib/lib")
library("rattle", lib.loc="D:/R/Lib/lib")
.libPaths()
q()
.libPaths()
q()
install.packages("devtools")
library(devtools)
install_github("rstudio")
install_github(rstudio)
q()
install.packages("maps")
install.packages("mapproj")
getwd()
q()
install.packages("d3heatmap")
install.packages("gplots")
q()
q()
install.packages("XML")
library(XML)
tmp <- readHTMLTable("http://siis.twse.com.tw/publish/sii/105IRB100_01.HTM")
install.packages("RCurl")
url <- "http://siis.twse.com.tw/publish/sii/105IRB100_01.HTM"
doc <- htmlParse(url, encoding = "big5")
doc
tmp <- readHTMLTable(doc)
doc <- htmlParse(url, encoding = 'big5')
doc
doc <- htmlParse(url)
doc
doc <- htmlParse(url, encoding = 'big5')
doc
tmp <- readHTMLTable(doc)
doc <- htmlParse(url, encoding = 'BIG5')
doc
library(XML)
library(RCurl)
library(httr)
Sys.setlocale(category='LC_ALL', locale='C')
url='http://www.twse.com.tw/ch/trading/indices/twco/tai50i.php'
get_url_parse =htmlParse(url,encoding ='BIG5')
tablehead <- xpathSApply(get_url_parse, "//tr[@class='tb2']/td", xmlValue)
tablehead<-iconv(tablehead,"UTF-8","CP950")
table <- matrix(tablehead, ncol = 6, byrow = T)
View(table)
url <- "http://siis.twse.com.tw/publish/sii/105IRB100_01.HTM"
doc <- htmlParse(url, encoding = 'BIG5')
tmp <- readHTMLTable(doc)
tmp
url <- "http://siis.twse.com.tw/publish/sii/105IRB100_01.HTM"
doc <- htmlParse(url, encoding = 'BIG5')
tmp <- readHTMLTable(doc)
tmp
url <- "http://siis.twse.com.tw/publish/sii/105IRB100_01.HTM"
doc <- htmlParse(url, encoding = 'BIG5')
tmp <- readHTMLTable(doc)
tmp
head(tmp)
tmp
rversion
version
library(quantmod)
install.packages("quantmod")
library(quantmod)
getFin("TPE:2330", env=twsec, "BS", "A")
twsec <- new.env()
getFin("TPE:2330", env=twsec, "BS", "A")
q()
library(XLConnect)
wb <- loadWorkbook("./datafile/misc/201601　台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
wb <- loadWorkbook("201601　台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
wb <- loadWorkbook("20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
setwd("D:/Git/CC/GH/reposilo／asdf/datafile/misc")
wb <- loadWorkbook("20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
setwd("D:/Git/CC/GH/reposilo／asdf")
wb <- loadWorkbook("./datafile/misc/20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A2:E109', header = TRUE, stringsAsFactors = FALSE)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A2:E109', header = TRUE)
View(underHolder)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A1:E109', header = TRUE)
listedFS <- readWorksheet(object = wb, sheet =2, region ='A1:L1868', header = TRUE, stringsAsFactors = FALSE)
listedFS <- readWorksheet(object = wb, sheet =2, region ='A1:L1868', header = TRUE)
View(listedFS)
View(underHolder)
View(listedFS)
library(dplyr)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼＂)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
typeof(underHolder$股票代碼)
class(underHolder$股票代碼)
class(listedFS$股票代碼)
as.character(underHolder$股票代碼)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
class(listedFS)
str(listedFS)
wb <- loadWorkbook("./datafile/misc/20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A1:E109', header = TRUE)
listedFS <- readWorksheet(object = wb, sheet =2, region ='A1:L1868', header = TRUE)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
str(listedFS)
str(underHolder)
underHolder$股票代碼 <- as.character(underHolder$股票代碼)
View(underHolder)
View(listedFS)
View(underHolder)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
View(df)
wb <- loadWorkbook("./datafile/misc/20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A1:E109', header = TRUE)
listedFS <- readWorksheet(object = wb, sheet =2, region ='A1:L1868', header = TRUE)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
str(listedFS)
str(underHolder)
underHolder$股票代碼 <- as.character(underHolder$股票代碼)
class(underHolder$股票代碼)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
View(df)
df <- df[-c("公司名稱.y", "交易市場.y")]
View(df)
names(df)
df[-c("公司名稱.y", "交易市場.y")]
df <- subset(df, select = -c("公司名稱.y", "交易市場.y"))
df <- df[ , -which(names(df) %in% c("公司名稱.y","交易市場.y"))]
View(df)
names(df)
which(names(df)) == "公司名稱.x"
which(names(df) == "公司名稱.x")
names(df[which(names(df) == "公司名稱.x")] <- 公司名稱
names(df[which(names(df) == "公司名稱.x")]) <- "公司名稱"
View(df)
names(df$公司名稱.x) <- "公司名稱"
View(df)
names(df)
names(df[2]) <- "公司名稱"
View(df)
df[2]
install.packages("plyr")
rename(df, c("公司名稱.x"="公司名稱", "交易市場.x"="交易市場"))
names(df)[names(df)=="公司名稱.x"] <- "公司名稱"
View(df)
names(df)[names(df)=="交易市場.x"] <- "交易市場"
View(df)
str(df)
df$業外收支 <- as.numeric(underHolder$業外收支)
View(df)
df$每股純益 <- as.numeric(df$每股純益)
View(df)
str(df)
df$流動比率 <- as.numeric(df$流動比率)
View(df)
str(df)
df$業外收支 <- as.numeric(df$業外收支)
View(df)
View(df)
wb <- loadWorkbook("./datafile/misc/20160131台灣上市、上櫃、興櫃公司董監持股不足.xls", create = FALSE)
underHolder <- readWorksheet(object = wb, sheet = 1, region ='A1:E109', header = TRUE)
listedFS <- readWorksheet(object = wb, sheet =2, region ='A1:L1868', header = TRUE)
underHolder$股票代碼 <- as.character(underHolder$股票代碼)
df <- dplyr::inner_join(underHolder, listedFS, by="股票代碼" )
df <- df[ , -which(names(df) %in% c("公司名稱.y","交易市場.y"))]
names(df)[names(df)=="公司名稱.x"] <- "公司名稱"
names(df)[names(df)=="交易市場.x"] <- "交易市場"
View(df)
str(df)
df$業外收支 <- gsub(",", "", df$業外收支)
View(df)
df$業外收支 <- as.numeric(df$業外收支)
View(df)
df$每股純益 <- as.numeric(df$每股純益)
df$流動比率 <- as.numeric(df$流動比率)
str(df)
write.csv(df, "./misc/201601董監持股不足.csv")
write.csv(df, file = "./misc/201601董監持股不足.csv")
write.csv(df, file = "./datafile/misc/201601董監持股不足.csv")
q()
